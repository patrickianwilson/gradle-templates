

task assembleDockerImage(type: Exec) {
    workingDir "$projectDir"
    commandLine 'docker', 'build', '-f', project.dockerFile, '-t', project.dockerTag, project.dockerWorkingDir
    standardOutput = new ByteArrayOutputStream()

    ext.output = {
        return standardOutput.toString()
    }

    inputs.file "${projectDir}/deploy/Dockerfile"
    inputs.dir "${projectDir}/deploy/stage"

}

task publishDockerImageToGCR(type: Exec) {
    workingDir "$projectDir"
    commandLine 'docker', 'build', '-f', project.dockerFile, '-t', project.dockerTag, project.dockerWorkingDir
    standardOutput = new ByteArrayOutputStream()

    ext.output = {
        return standardOutput.toString()
    }

    inputs.file "${projectDir}/deploy/Dockerfile"
    inputs.dir "${projectDir}/deploy/stage"
}