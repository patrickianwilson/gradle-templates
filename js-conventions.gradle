/*
This Gradle plugin will provide support for javascript applications.
 */
task clean

task installNodeTools(type: Exec) {
    workingDir "$projectDir"
    commandLine 'npm', 'install'

    outputs.dir "${projectDir}/node_modules"
    inputs.file "${projectDir}/package.json"


}


task gulpClean(type: Exec) {
    workingDir "$projectDir"
    commandLine 'gulp', 'clean'
    
    inputs.file "${projectDir}/gulpfile.js"
    inputs.dir "${projectDir}/deploy/stage"
}

clean.dependsOn gulpClean

task assembleJs(type: Exec, dependsOn: "installNodeTools") {
    workingDir "$projectDir"
    commandLine 'gulp', 'stage'
    standardOutput = new ByteArrayOutputStream()

    inputs.file "${projectDir}/gulpfile.js"
    inputs.dir "${projectDir}/src"

    outputs.dir "${projectDir}/deploy/stage"
}